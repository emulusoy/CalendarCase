@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EMU | Calendar</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <link rel="stylesheet" href="/calendaradmin/plugins/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="/calendaradmin/plugins/fullcalendar/main.css">
    <link rel="stylesheet" href="/calendaradmin/dist/css/adminlte.min.css">
    <style>
        .custom-navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1030;
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

            .nav-links.left {
                margin-right: auto;
            }

            .nav-links.right {
                margin-left: auto;
            }

            .nav-links a {
                text-decoration: none;
                color: #333;
                font-weight: 500;
                font-size: 16px;
                transition: color 0.3s;
            }

                .nav-links a:hover {
                    color: #4a6cf7;
                }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: sandybrown;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Takvim alanını düzenle */
        .content-wrapper {
            margin-left: 0 !important;
            padding: 20px;
            margin-top: 20px;
        }

        /* Kart stil düzenlemeleri */
        .card {
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            border: none;
        }

        .card-header {
            background-color: white;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="hold-transition sidebar-collapse">
    <div class="wrapper">
        <nav class="custom-navbar">
            <div class="nav-links left">
                <a href="#">Home</a>
                <a href="#">Event</a>
            </div>

            <div class="logo">EMU</div>

            <div class="nav-links right">
                <a href="#">Category</a>
                <a href="#">Settings</a>
            </div>
        </nav>
        <div class="content-wrapper">
            <section class="content-header">
                <div class="container-fluid">
                </div>
            </section>
            <section class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="sticky-top mb-3">
                                @Html.Partial("~/Views/Event/_EventMenu.cshtml")

                            </div>
                        </div>
                        <div class="col-md-9">
                            <div class="card card-primary">
                                <div class="card-body p-0">
                                    <div id="calendar"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <footer class="main-footer">
            <div class="float-right d-none d-sm-block">
                <b>Version</b> 3.2.0
            </div>
            <strong>Copyright &copy; 2023 EMU Calendar</strong> All rights reserved.
        </footer>
    </div>
    <script src="/calendaradmin/plugins/jquery/jquery.min.js"></script>
    <script src="/calendaradmin/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/calendaradmin/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="/calendaradmin/dist/js/adminlte.min.js"></script>
    <script src="/calendaradmin/plugins/moment/moment.min.js"></script>
    <script src="/calendaradmin/plugins/fullcalendar/main.js"></script>
    <script src="/calendaradmin/dist/js/demo.js"></script>
    <script>
        $(function () {
          /* initialize the external events */
          function ini_events(ele) {
            ele.each(function () {
              var eventObject = {
                title: $.trim($(this).text()) // Etkinlik başlığı
              }

              $(this).data('eventObject', eventObject)

              $(this).draggable({
                zIndex: 1070,
                revert: true,
                revertDuration: 0
              })
            })
          }

          ini_events($('#external-events div.external-event'))

          var date = new Date()
          var d = date.getDate(),
              m = date.getMonth(),
              y = date.getFullYear()

          var Calendar = FullCalendar.Calendar;
          var Draggable = FullCalendar.Draggable;

          var containerEl = document.getElementById('external-events');
          var checkbox = document.getElementById('drop-remove');
          var calendarEl = document.getElementById('calendar');

          new Draggable(containerEl, {
            itemSelector: '.external-event',
            eventData: function (eventEl) {
              return {
                title: eventEl.innerText,
                backgroundColor: window.getComputedStyle(eventEl, null).getPropertyValue('background-color'),
                borderColor: window.getComputedStyle(eventEl, null).getPropertyValue('background-color'),
                textColor: window.getComputedStyle(eventEl, null).getPropertyValue('color'),
              };
            }
          });

          var calendar = new Calendar(calendarEl, {
            headerToolbar: {
              left: 'prev,next today',
              center: 'title',
              right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            themeSystem: 'bootstrap',
            events: [
              {
                title: 'All Day Event',
                start: new Date(y, m, 1),
                backgroundColor: '#f56954',
                borderColor: '#f56954',
                allDay: true
              },
              {
                title: 'Long Event',
                start: new Date(y, m, d - 5),
                end: new Date(y, m, d - 2),
                backgroundColor: '#f39c12',
                borderColor: '#f39c12'
              }
            ],
            editable: true,
            droppable: true,
            drop: function (info) {
              if (checkbox.checked) {
                info.draggedEl.parentNode.removeChild(info.draggedEl);
              }
            }
          });

          calendar.render();

          // ✅ Add New Event (Dropdown üzerinden renk seçimi)
          $('#add-new-event').click(function (e) {
            e.preventDefault();

            var val = $('#new-event').val().trim();
            var selectedClass = $('#color-select').val();

            if (val.length === 0) {
              alert("Lütfen etkinlik başlığı girin.");
              return;
            }

            // Renk haritası
            var colorMap = {
              'bg-primary': '#007bff',
              'bg-warning': '#ffc107',
              'bg-success': '#28a745',
              'bg-danger': '#dc3545',
              'bg-secondary': '#6c757d'
            };

            var bgColor = colorMap[selectedClass] || '#3c8dbc';

            // Yeni etkinlik div'i
            var event = $('<div />');
            event.css({
              'background-color': bgColor,
              'border-color': bgColor,
              'color': '#fff'
            }).addClass('external-event').addClass(selectedClass);

            event.text(val);

            // Sayfaya ekle ve draggable yap
            $('#external-events').prepend(event);
            ini_events(event);

            // Temizle
            $('#new-event').val('');
            $('#color-select').prop('selectedIndex', 0);
          });
        });
    </script>

</body>
</html>